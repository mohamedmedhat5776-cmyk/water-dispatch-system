<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุธุงู ุชุณุฌูู ุจูุงูุงุช ุงูููุงู - ูุณูุฏู</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .header {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            padding: 20px 0;
            margin-bottom: 30px;
        }
        .nav-tabs .nav-link {
            color: #495057;
            font-weight: 500;
        }
        .nav-tabs .nav-link.active {
            background-color: #007bff;
            color: white;
            border: none;
        }
        .form-section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .btn-primary {
            background: linear-gradient(135deg, #007bff, #0056b3);
            border: none;
            padding: 10px 30px;
        }
        .btn-success {
            background: linear-gradient(135deg, #28a745, #1e7e34);
            border: none;
            padding: 10px 30px;
        }
    </style>
</head>
<body>
    <div class="header text-center">
        <h1>ูุธุงู ุชุณุฌูู ุจูุงูุงุช ุงูููุงู - ูุญุงูุธุฉ ูุณูุฏู</h1>
        <p class="mb-0">Al Tayer Engineering Services LLC</p>
    </div>

    <div class="container">
        <ul class="nav nav-tabs mb-4" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="dispatch-tab" data-bs-toggle="tab" data-bs-target="#dispatch" type="button" role="tab">
                    ุชุณุฌูู ุจูุงูุงุช ุงูุชูุฒูุน
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="meter-tab" data-bs-toggle="tab" data-bs-target="#meter" type="button" role="tab">
                    ุชุณุฌูู ูุฑุงุกุงุช ุงูุนุฏุงุฏุงุช
                </button>
            </li>
        </ul>

        <div class="tab-content" id="myTabContent">
            <!-- ุชุจููุจ ุชุณุฌูู ุจูุงูุงุช ุงูุชูุฒูุน -->
            <div class="tab-pane fade show active" id="dispatch" role="tabpanel">
                <div class="form-section">
                    <h3 class="mb-4 text-primary">๐ฆ ุชุณุฌูู ุจูุงูุงุช ุงูุชูุฒูุน ุงููููู</h3>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">ุงููููุน</label>
                            <select class="form-select" id="locationSelect">
                                <option value="">ุงุฎุชุฑ ุงููููุน</option>
                                <!-- ุณูุชู ููุก ุงูููุงูุน ุชููุงุฆูุงู ูู JavaScript -->
                            </select>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label class="form-label">ุงููููุฉ ุงูููุฒุนุฉ (mยณ)</label>
                            <input type="number" class="form-control" id="quantity" placeholder="ุฃุฏุฎู ุงููููุฉ">
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">ุงูุชุงุฑูุฎ</label>
                            <input type="date" class="form-control" id="dispatchDate">
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label class="form-label">ุงูููู ูู ุงูุดูุฑ</label>
                            <select class="form-select" id="dayOfMonth">
                                <option value="">ุงุฎุชุฑ ุงูููู</option>
                                <!-- ุณูุชู ููุก ุงูุฃูุงู ูู 1 ุฅูู 31 -->
                            </select>
                        </div>
                    </div>

                    <div class="text-center mt-4">
                        <button class="btn btn-primary btn-lg" onclick="saveDispatchData()">
                            ๐พ ุญูุธ ุจูุงูุงุช ุงูุชูุฒูุน
                        </button>
                    </div>
                </div>
            </div>

            <!-- ุชุจููุจ ุชุณุฌูู ูุฑุงุกุงุช ุงูุนุฏุงุฏุงุช -->
            <div class="tab-pane fade" id="meter" role="tabpanel">
                <div class="form-section">
                    <h3 class="mb-4 text-success">๐ ุชุณุฌูู ูุฑุงุกุงุช ุงูุนุฏุงุฏุงุช</h3>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">ุฑูู ุงูุณูููุฉ</label>
                            <select class="form-select" id="shipNumber">
                                <option value="">ุงุฎุชุฑ ุงูุณูููุฉ</option>
                                <option value="1">ุงูุณูููุฉ 1</option>
                                <option value="2">ุงูุณูููุฉ 2</option>
                                <option value="3">ุงูุณูููุฉ 3</option>
                                <option value="4">ุงูุณูููุฉ 4</option>
                            </select>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label class="form-label">ุงูุชุงุฑูุฎ</label>
                            <input type="date" class="form-control" id="meterDate">
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label class="form-label">ุงููุฑุงุกุฉ ุงูููุงุฆูุฉ - ุนุฏุงุฏ 1 (ุงูููู ุงูุญุงูู)</label>
                            <input type="number" class="form-control" id="meter1Final">
                        </div>
                        
                        <div class="col-md-4 mb-3">
                            <label class="form-label">ุงููุฑุงุกุฉ ุงูููุงุฆูุฉ - ุนุฏุงุฏ 2 (ุงูููู ุงูุญุงูู)</label>
                            <input type="number" class="form-control" id="meter2Final">
                        </div>
                        
                        <div class="col-md-4 mb-3">
                            <label class="form-label">ุงููุฑุงุกุฉ ุงูููุงุฆูุฉ - ุนุฏุงุฏ 1 (ุงูููู ุงูุณุงุจู)</label>
                            <input type="number" class="form-control" id="meter1Previous">
                        </div>
                    </div>

                    <div class="text-center mt-4">
                        <button class="btn btn-success btn-lg" onclick="saveMeterData()">
                            ๐พ ุญูุธ ูุฑุงุกุงุช ุงูุนุฏุงุฏุงุช
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ููุทูุฉ ุงูุฅุดุนุงุฑุงุช -->
        <div id="alertArea"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // ูุงุฆูุฉ ุงูููุงูุน ูู ููู Excel
        const locations = [
            "Hafa", "Hafa Nakhal", "Danab", "Hafa Sheeb", "Hafa Yadar", "Khor meha", 
            "Sanat", "Khor Meala", "Sharya Aq", "Sharya Hel", "Maysar", "Addas", 
            "Sadwain", "Dess", "Hekel", "Deni", "Aqaba", "Aimes", "Khesa", "Mawi",
            "Habalain", "Ghafool", "Muqaqa", "Khab Al show", "Maqlab B", "Ras Amud Co.",
            "Boot", "Film", "Najed", "Mansal", "Mayat", "Neba", "Shaboos", "Maqta",
            "Suwayrat", "Balad", "Mantaf", "Al Sebatah", "Doorsuni", "Taheet", "Murwany",
            "Sefet Bait", "Sharyat Shesa", "Ghub Ali", "Sowayra", "Ghub Qad", "Ghurm",
            "Mazaya Co.", "Jum", "Qabba", "Maqlab Kumzar", "Fardha", "Qalta", "Kheran",
            "Maysag", "Kukba", "Manjal", "Meali", "Safa", "Sefat Zangi", "R.Shk.Mas",
            "Towalah", "Aydah", "Fanakha", "Humssi", "Nadheefi", "Huwenia", "Qana",
            "Telegraph Co.", "Maqlab", "Sebi", "Tub", "Asha", "Shum", "Sefat Garib Co.", "Ghassa"
        ];

        // ุชููุฆุฉ ุงูุตูุญุฉ
        document.addEventListener('DOMContentLoaded', function() {
            // ููุก ูุงุฆูุฉ ุงูููุงูุน
            const locationSelect = document.getElementById('locationSelect');
            locations.forEach(location => {
                const option = document.createElement('option');
                option.value = location;
                option.textContent = location;
                locationSelect.appendChild(option);
            });

            // ููุก ูุงุฆูุฉ ุงูุฃูุงู
            const daySelect = document.getElementById('dayOfMonth');
            for (let i = 1; i <= 31; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i;
                daySelect.appendChild(option);
            }

            // ุชุนููู ุงูุชุงุฑูุฎ ุงูุญุงูู ูุงูุชุฑุงุถู
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('dispatchDate').value = today;
            document.getElementById('meterDate').value = today;
        });

        // ุฏุงูุฉ ุญูุธ ุจูุงูุงุช ุงูุชูุฒูุน
        function saveDispatchData() {
            const location = document.getElementById('locationSelect').value;
            const quantity = document.getElementById('quantity').value;
            const date = document.getElementById('dispatchDate').value;
            const dayOfMonth = document.getElementById('dayOfMonth').value;

            console.log('ุจูุงูุงุช ุงูุชูุฒูุน:', { location, quantity, date, dayOfMonth });

            if (!location || !quantity || !date || !dayOfMonth) {
                showAlert('ูุฑุฌู ููุก ุฌููุน ุงูุญููู', 'danger');
                return;
            }

            // ููุง ุณูุชู ุงูุงุชุตุงู ุจู Python ููุชุงุจุฉ ุงูุจูุงูุงุช ูู Excel
            const data = {
                type: 'dispatch',
                location: location,
                quantity: quantity,
                date: date,
                dayOfMonth: dayOfMonth
            };

            sendToPython(data);
        }

        // ุฏุงูุฉ ุญูุธ ูุฑุงุกุงุช ุงูุนุฏุงุฏุงุช
        function saveMeterData() {
            const shipNumber = document.getElementById('shipNumber').value;
            const date = document.getElementById('meterDate').value;
            const meter1Final = document.getElementById('meter1Final').value;
            const meter2Final = document.getElementById('meter2Final').value;
            const meter1Previous = document.getElementById('meter1Previous').value;

            console.log('ุจูุงูุงุช ุงูุนุฏุงุฏุงุช:', { shipNumber, date, meter1Final, meter2Final, meter1Previous });

            if (!shipNumber || !date || !meter1Final || !meter2Final || !meter1Previous) {
                showAlert('ูุฑุฌู ููุก ุฌููุน ุงูุญููู', 'danger');
                return;
            }

            // ููุง ุณูุชู ุงูุงุชุตุงู ุจู Python ููุชุงุจุฉ ุงูุจูุงูุงุช ูู Excel
            const data = {
                type: 'meter',
                shipNumber: shipNumber,
                date: date,
                meter1Final: meter1Final,
                meter2Final: meter2Final,
                meter1Previous: meter1Previous
            };

            sendToPython(data);
        }

        // ุฏุงูุฉ ุฅุฑุณุงู ุงูุจูุงูุงุช ูู Python
        function sendToPython(data) {
            console.log('ุฌุงุฑู ุฅุฑุณุงู ุงูุจูุงูุงุช ูู Python:', data);
            
            fetch('/save_data', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(result => {
                console.log('ูุชูุฌุฉ ุงูุญูุธ:', result);
                if (result.success) {
                    showAlert('ุชู ุญูุธ ุงูุจูุงูุงุช ุจูุฌุงุญ!', 'success');
                    // ุชูุธูู ุงูุญููู ุจุนุฏ ุงูุญูุธ
                    if (data.type === 'dispatch') {
                        document.getElementById('quantity').value = '';
                    } else {
                        document.getElementById('meter1Final').value = '';
                        document.getElementById('meter2Final').value = '';
                        document.getElementById('meter1Previous').value = '';
                    }
                } else {
                    showAlert('ูุดู ูู ุญูุธ ุงูุจูุงูุงุช: ' + result.message, 'danger');
                }
            })
            .catch(error => {
                console.error('ุฎุทุฃ ูู ุงูุฅุฑุณุงู:', error);
                showAlert('ุฎุทุฃ ูู ุงูุงุชุตุงู ุจุงูุณูุฑูุฑ', 'danger');
            });
        }

        // ุฏุงูุฉ ุนุฑุถ ุงูุฅุดุนุงุฑุงุช
        function showAlert(message, type) {
            const alertArea = document.getElementById('alertArea');
            const alert = document.createElement('div');
            alert.className = `alert alert-${type} alert-dismissible fade show`;
            alert.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            alertArea.appendChild(alert);
            
            // ุฅุฒุงูุฉ ุงูุฅุดุนุงุฑ ุชููุงุฆูุงู ุจุนุฏ 5 ุซูุงูู
            setTimeout(() => {
                alert.remove();
            }, 5000);
        }
    </script>
</body>
</html>